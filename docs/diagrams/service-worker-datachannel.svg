<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1727px" preserveAspectRatio="none" style="width:1106px;height:1727px;background:#0F172A;" version="1.1" viewBox="0 0 1106 1727" width="1106px" zoomAndPan="magnify"><title>Service Worker DataChannel Tunneling</title><defs/><g><rect fill="#0F172A" height="1727" style="stroke:none;stroke-width:1;" width="1106" x="0" y="0"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="487.3838" x="308.1948" y="35.4209">Service Worker DataChannel Tunneling</text><rect fill="#1E293B" height="1185.2188" style="stroke:#334155;stroke-width:1;" width="10" x="182.4902" y="415.2344"/><rect fill="#1E293B" height="824.7813" style="stroke:#334155;stroke-width:1;" width="10" x="417.5684" y="678.7969"/><rect fill="#1E293B" height="505.3125" style="stroke:#334155;stroke-width:1;" width="10" x="668.6563" y="873.4531"/><rect fill="#1E293B" height="457.375" style="stroke:#334155;stroke-width:1;" width="10" x="860.25" y="901.4219"/><rect fill="#FFFFFF" height="269.5625" style="stroke:#334155;stroke-width:1;" width="327.7158" x="607.6973" y="1082.2344"/><rect fill="#FFFFFF" height="197.6875" style="stroke:none;stroke-width:1;" width="327.7158" x="607.6973" y="1154.1094"/><line style="stroke:#334155;stroke-width:1;" x1="59" x2="59" y1="94.5469" y2="1680.3594"/><line style="stroke:#334155;stroke-width:1;" x1="187.3154" x2="187.3154" y1="94.5469" y2="1680.3594"/><line style="stroke:#334155;stroke-width:1;" x1="421.8047" x2="421.8047" y1="94.5469" y2="1680.3594"/><line style="stroke:#334155;stroke-width:1;" x1="672.6973" x2="672.6973" y1="94.5469" y2="1680.3594"/><line style="stroke:#334155;stroke-width:1;" x1="865.0869" x2="865.0869" y1="94.5469" y2="1680.3594"/><line style="stroke:#334155;stroke-width:1;" x1="1051.0352" x2="1051.0352" y1="94.5469" y2="1680.3594"/><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="68.3047" x="25" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="54.123" x="32.0908" y="69.748">Web App</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="54.3047" x="32" y="83.7168">(page JS)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="68.3047" x="25" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="54.123" x="32.0908" y="1697.498">Web App</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="54.3047" x="32" y="1711.4668">(page JS)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="58.3496" x="158.3154" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="44.3496" x="165.3154" y="69.748">Service</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="43.4063" x="165.7871" y="83.7168">Worker</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="58.3496" x="158.3154" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="44.3496" x="165.3154" y="1697.498">Service</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="43.4063" x="165.7871" y="1711.4668">Worker</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="77.5273" x="383.8047" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="45.3809" x="399.8779" y="69.748">webrtc-</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="63.5273" x="390.8047" y="83.7168">upgrade.js</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="77.5273" x="383.8047" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="45.3809" x="399.8779" y="1697.498">webrtc-</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="63.5273" x="390.8047" y="1711.4668">upgrade.js</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="91.918" x="627.6973" y="65.5781"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="77.918" x="634.6973" y="83.7168">DataChannel</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="91.918" x="627.6973" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="77.918" x="634.6973" y="1697.498">DataChannel</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="100.3262" x="815.0869" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="26.9766" x="851.7617" y="69.748">WAF</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="86.3262" x="822.0869" y="83.7168">(peer handler)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="100.3262" x="815.0869" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="26.9766" x="851.7617" y="1697.498">WAF</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="86.3262" x="822.0869" y="1711.4668">(peer handler)</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="65.7383" x="1019.0352" y="65.5781"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="51.7383" x="1026.0352" y="83.7168">Backend</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="65.7383" x="1019.0352" y="1679.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="51.7383" x="1026.0352" y="1697.498">Backend</text><rect fill="#1E293B" height="1185.2188" style="stroke:#334155;stroke-width:1;" width="10" x="182.4902" y="415.2344"/><rect fill="#1E293B" height="824.7813" style="stroke:#334155;stroke-width:1;" width="10" x="417.5684" y="678.7969"/><rect fill="#1E293B" height="505.3125" style="stroke:#334155;stroke-width:1;" width="10" x="668.6563" y="873.4531"/><rect fill="#1E293B" height="457.375" style="stroke:#334155;stroke-width:1;" width="10" x="860.25" y="901.4219"/><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1094.7734" x="5" y="124.5313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1099.7734" y1="124.5313" y2="124.5313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1099.7734" y1="127.5313" y2="127.5313"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="241.7773" x="431.498" y="114.5469"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223.5996" x="437.498" y="129.6855">Setup (after DataChannel opens)</text><line style="stroke:#94A3B8;stroke-width:1;" x1="422.5684" x2="464.5684" y1="180.4531" y2="180.4531"/><line style="stroke:#94A3B8;stroke-width:1;" x1="464.5684" x2="464.5684" y1="180.4531" y2="193.4531"/><line style="stroke:#94A3B8;stroke-width:1;" x1="423.5684" x2="464.5684" y1="193.4531" y2="193.4531"/><polygon fill="#94A3B8" points="433.5684,189.4531,423.5684,193.4531,433.5684,197.4531,429.5684,193.4531" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="146.1152" x="429.5684" y="161.6543">GET /auth/session-token</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="237.0879" x="429.5684" y="175.623">(via HTTP relay, reads HttpOnly cookie)</text><line style="stroke:#94A3B8;stroke-width:1;" x1="422.5684" x2="464.5684" y1="221.4219" y2="221.4219"/><line style="stroke:#94A3B8;stroke-width:1;" x1="464.5684" x2="464.5684" y1="221.4219" y2="234.4219"/><line style="stroke:#94A3B8;stroke-width:1;" x1="423.5684" x2="464.5684" y1="234.4219" y2="234.4219"/><polygon fill="#94A3B8" points="433.5684,230.4219,423.5684,234.4219,433.5684,238.4219,429.5684,234.4219" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="133.8984" x="429.5684" y="216.5918">Store JWT for injection</text><polygon fill="#94A3B8" points="198.4902,272.3594,188.4902,276.3594,198.4902,280.3594,194.4902,276.3594" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="421.5684" y1="276.3594" y2="276.3594"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="97.4941" x="204.4902" y="257.5605">register /js/sw.js</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="67.4941" x="204.4902" y="271.5293">(scope: "/")</text><polygon fill="#94A3B8" points="198.4902,300.3281,188.4902,304.3281,198.4902,308.3281,194.4902,304.3281" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="421.5684" y1="304.3281" y2="304.3281"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="211.0781" x="204.4902" y="299.498">postMessage({ type: "dc_ready" })</text><line style="stroke:#94A3B8;stroke-width:1;" x1="187.4902" x2="229.4902" y1="332.2969" y2="332.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="229.4902" x2="229.4902" y1="332.2969" y2="345.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="188.4902" x2="229.4902" y1="345.2969" y2="345.2969"/><polygon fill="#94A3B8" points="198.4902,341.2969,188.4902,345.2969,198.4902,349.2969,194.4902,345.2969" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="157.2539" x="194.4902" y="327.4668">Add client to dcClients set</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1094.7734" x="5" y="373.2813"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1099.7734" y1="373.2813" y2="373.2813"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1099.7734" y1="376.2813" y2="376.2813"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="143.3633" x="480.7051" y="363.2969"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125.1855" x="486.7051" y="378.4355">Fetch Interception</text><polygon fill="#94A3B8" points="170.4902,411.2344,180.4902,415.2344,170.4902,419.2344,174.4902,415.2344" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="59.1523" x2="176.4902" y1="415.2344" y2="415.2344"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="104.3379" x="66.1523" y="410.4043">fetch("/api/data")</text><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="234.4902" y1="499.0781" y2="499.0781"/><line style="stroke:#94A3B8;stroke-width:1;" x1="234.4902" x2="234.4902" y1="499.0781" y2="512.0781"/><line style="stroke:#94A3B8;stroke-width:1;" x1="193.4902" x2="234.4902" y1="512.0781" y2="512.0781"/><polygon fill="#94A3B8" points="203.4902,508.0781,193.4902,512.0781,203.4902,516.0781,199.4902,512.0781" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="55.1309" x="199.4902" y="438.373">Decision:</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="94.9277" x="207.1191" y="452.3418">navigate? &#8594; NO</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="112.3477" x="207.1191" y="466.3105">cross-origin? &#8594; NO</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="100.5469" x="207.1191" y="480.2793">WAF path? &#8594; NO</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="152.5781" x="207.1191" y="494.248">&#8594; Route via DataChannel</text><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="234.4902" y1="567.9844" y2="567.9844"/><line style="stroke:#94A3B8;stroke-width:1;" x1="234.4902" x2="234.4902" y1="567.9844" y2="580.9844"/><line style="stroke:#94A3B8;stroke-width:1;" x1="193.4902" x2="234.4902" y1="580.9844" y2="580.9844"/><polygon fill="#94A3B8" points="203.4902,576.9844,193.4902,580.9844,203.4902,584.9844,199.4902,580.9844" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="115.9629" x="199.4902" y="535.2168">Rewrite URL prefix:</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="123.9258" x="199.4902" y="549.1855">page at /__b/App1/...</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="126.0703" x="199.4902" y="563.1543">&#8594; /__b/App1/api/data</text><polygon fill="#94A3B8" points="405.5684,674.7969,415.5684,678.7969,405.5684,682.7969,409.5684,678.7969" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="411.5684" y1="678.7969" y2="678.7969"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="83.1914" x="199.4902" y="604.123">postMessage(</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="111.6973" x="207.1191" y="618.0918">{ type: "dc_fetch",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="150.7852" x="214.748" y="632.0605">url: "/__b/App1/api/data",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="93.2637" x="214.748" y="646.0293">method: "GET",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="98.3613" x="214.748" y="659.998">headers: {...} },</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="90.8555" x="207.1191" y="673.9668">[MessagePort])</text><line style="stroke:#94A3B8;stroke-width:1;" x1="427.5684" x2="469.5684" y1="720.7344" y2="720.7344"/><line style="stroke:#94A3B8;stroke-width:1;" x1="469.5684" x2="469.5684" y1="720.7344" y2="733.7344"/><line style="stroke:#94A3B8;stroke-width:1;" x1="428.5684" x2="469.5684" y1="733.7344" y2="733.7344"/><polygon fill="#94A3B8" points="438.5684,729.7344,428.5684,733.7344,438.5684,737.7344,434.5684,733.7344" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="107.9473" x="434.5684" y="701.9355">Inject session JWT</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="111.8379" x="434.5684" y="715.9043">into cookie header</text><polygon fill="#94A3B8" points="656.6563,869.4531,666.6563,873.4531,656.6563,877.4531,660.6563,873.4531" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="427.5684" x2="662.6563" y1="873.4531" y2="873.4531"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="128.3555" x="434.5684" y="756.873">send(JSON.stringify({</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="126.0293" x="442.1973" y="770.8418">type: "http_request",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="71.7891" x="442.1973" y="784.8105">id: "uuid-1",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="93.2637" x="442.1973" y="798.7793">method: "GET",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="150.7852" x="442.1973" y="812.748">url: "/__b/App1/api/data",</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="64.0195" x="442.1973" y="826.7168">headers: {</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="173.6895" x="449.8262" y="840.6855">cookie: "waf_access=&lt;jwt&gt;"</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="11.4492" x="442.1973" y="854.6543">},</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="69.3867" x="442.1973" y="868.623">body: "" }))</text><polygon fill="#94A3B8" points="848.25,897.4219,858.25,901.4219,848.25,905.4219,852.25,901.4219" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="678.6563" x2="854.25" y1="901.4219" y2="901.4219"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="135.6621" x="685.6563" y="896.5918">DataChannel message</text><line style="stroke:#94A3B8;stroke-width:1;" x1="870.25" x2="912.25" y1="943.3594" y2="943.3594"/><line style="stroke:#94A3B8;stroke-width:1;" x1="912.25" x2="912.25" y1="943.3594" y2="956.3594"/><line style="stroke:#94A3B8;stroke-width:1;" x1="871.25" x2="912.25" y1="956.3594" y2="956.3594"/><polygon fill="#94A3B8" points="881.25,952.3594,871.25,956.3594,881.25,960.3594,877.25,956.3594" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="142.4297" x="877.25" y="924.5605">HTTP to 127.0.0.1:7891</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="152.6543" x="877.25" y="938.5293">(loopback through proxy)</text><line style="stroke:#94A3B8;stroke-width:1;" x1="870.25" x2="912.25" y1="998.2969" y2="998.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="912.25" x2="912.25" y1="998.2969" y2="1011.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="871.25" x2="912.25" y1="1011.2969" y2="1011.2969"/><polygon fill="#94A3B8" points="881.25,1007.2969,871.25,1011.2969,881.25,1015.2969,877.25,1011.2969" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="129.2109" x="877.25" y="979.498">Strip /__b/App1 prefix</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="96.7324" x="877.25" y="993.4668">Verify JWT &#8594; OK</text><polygon fill="#94A3B8" points="1039.9043,1035.2656,1049.9043,1039.2656,1039.9043,1043.2656,1043.9043,1039.2656" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="870.25" x2="1045.9043" y1="1039.2656" y2="1039.2656"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="81.4453" x="877.25" y="1034.4355">GET /api/data</text><polygon fill="#94A3B8" points="881.25,1063.2344,871.25,1067.2344,881.25,1071.2344,877.25,1067.2344" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="875.25" x2="1050.9043" y1="1067.2344" y2="1067.2344"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="105.3105" x="887.25" y="1062.4043">200 { data: [...] }</text><path d="M607.6973,1082.2344 L670.6445,1082.2344 L670.6445,1088.2031 L660.6445,1098.2031 L607.6973,1098.2031 L607.6973,1082.2344 " fill="#1E293B" style="stroke:#334155;stroke-width:1;"/><rect fill="none" height="269.5625" style="stroke:#334155;stroke-width:1;" width="327.7158" x="607.6973" y="1082.2344"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="17.9473" x="622.6973" y="1094.373">alt</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138.0527" x="685.6445" y="1095.373">[Response &lt; 200KB]</text><polygon fill="#94A3B8" points="689.6563,1142.1094,679.6563,1146.1094,689.6563,1150.1094,685.6563,1146.1094" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="683.6563" x2="859.25" y1="1146.1094" y2="1146.1094"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="85.4004" x="695.6563" y="1113.3418">http_response</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="132.1992" x="695.6563" y="1127.3105">{ id, statusCode: 200,</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="149.0156" x="703.2852" y="1141.2793">headers, body: base64 }</text><line style="stroke:#334155;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="607.6973" x2="935.4131" y1="1155.1094" y2="1155.1094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210.6504" x="612.6973" y="1166.248">[Response &gt; 200KB (chunked)]</text><polygon fill="#94A3B8" points="689.6563,1213.9844,679.6563,1217.9844,689.6563,1221.9844,685.6563,1217.9844" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="683.6563" x2="859.25" y1="1217.9844" y2="1217.9844"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="119.3496" x="695.6563" y="1185.2168">http_response_start</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="157.5938" x="695.6563" y="1199.1855">{ id, statusCode, headers,</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="98.7773" x="703.2852" y="1213.1543">totalChunks: 3 }</text><polygon fill="#94A3B8" points="689.6563,1255.9219,679.6563,1259.9219,689.6563,1263.9219,685.6563,1259.9219" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="683.6563" x2="859.25" y1="1259.9219" y2="1259.9219"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="127.7637" x="695.6563" y="1241.123">http_response_chunk</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="155.0098" x="695.6563" y="1255.0918">{ id, index: 0, data: "..." }</text><polygon fill="#94A3B8" points="689.6563,1297.8594,679.6563,1301.8594,689.6563,1305.8594,685.6563,1301.8594" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="683.6563" x2="859.25" y1="1301.8594" y2="1301.8594"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="127.7637" x="695.6563" y="1283.0605">http_response_chunk</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="155.0098" x="695.6563" y="1297.0293">{ id, index: 1, data: "..." }</text><polygon fill="#94A3B8" points="689.6563,1339.7969,679.6563,1343.7969,689.6563,1347.7969,685.6563,1343.7969" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="683.6563" x2="859.25" y1="1343.7969" y2="1343.7969"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="127.7637" x="695.6563" y="1324.998">http_response_chunk</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="155.0098" x="695.6563" y="1338.9668">{ id, index: 2, data: "..." }</text><polygon fill="#94A3B8" points="438.5684,1374.7656,428.5684,1378.7656,438.5684,1382.7656,434.5684,1378.7656" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="432.5684" x2="672.6563" y1="1378.7656" y2="1378.7656"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="68.877" x="444.5684" y="1373.9355">onmessage</text><line style="stroke:#94A3B8;stroke-width:1;" x1="427.5684" x2="469.5684" y1="1420.7031" y2="1420.7031"/><line style="stroke:#94A3B8;stroke-width:1;" x1="469.5684" x2="469.5684" y1="1420.7031" y2="1433.7031"/><line style="stroke:#94A3B8;stroke-width:1;" x1="428.5684" x2="469.5684" y1="1433.7031" y2="1433.7031"/><polygon fill="#94A3B8" points="438.5684,1429.7031,428.5684,1433.7031,438.5684,1437.7031,434.5684,1433.7031" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="93.252" x="434.5684" y="1401.9043">Decode base64</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="141.4629" x="434.5684" y="1415.873">(or reassemble chunks)</text><polygon fill="#94A3B8" points="203.4902,1499.5781,193.4902,1503.5781,203.4902,1507.5781,199.4902,1503.5781" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="197.4902" x2="421.5684" y1="1503.5781" y2="1503.5781"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="119.2383" x="209.4902" y="1456.8418">port.postMessage({</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="102.1699" x="217.1191" y="1470.8105">statusCode: 200,</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="86.9121" x="217.1191" y="1484.7793">headers: {...},</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="97.541" x="217.1191" y="1498.748">body: base64 })</text><line style="stroke:#94A3B8;stroke-width:1;" x1="192.4902" x2="234.4902" y1="1559.4844" y2="1559.4844"/><line style="stroke:#94A3B8;stroke-width:1;" x1="234.4902" x2="234.4902" y1="1559.4844" y2="1572.4844"/><line style="stroke:#94A3B8;stroke-width:1;" x1="193.4902" x2="234.4902" y1="1572.4844" y2="1572.4844"/><polygon fill="#94A3B8" points="203.4902,1568.4844,193.4902,1572.4844,203.4902,1576.4844,199.4902,1572.4844" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="91.4707" x="199.4902" y="1526.7168">new Response(</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="67.166" x="207.1191" y="1540.6855">bodyBytes,</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="120.6094" x="207.1191" y="1554.6543">{ status, headers })</text><polygon fill="#94A3B8" points="70.1523,1596.4531,60.1523,1600.4531,70.1523,1604.4531,66.1523,1600.4531" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="64.1523" x2="186.4902" y1="1600.4531" y2="1600.4531"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="98.9648" x="76.1523" y="1595.623">Response object</text><path d="M10,1613.4531 L10,1664.4531 L915,1664.4531 L915,1623.4531 L905,1613.4531 L10,1613.4531 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><path d="M905,1613.4531 L905,1623.4531 L915,1623.4531 L905,1613.4531 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="283.7051" x="305.7222" y="1629.5918">Page navigations bypass SW &#8594; use HTTP relay.</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="304.9688" x="305.7222" y="1643.5605">Sub-resource fetches (API, assets) &#8594; DataChannel.</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="224.877" x="305.7222" y="1657.5293">10s timeout &#8594; fallback to HTTP relay.</text><!--SRC=[fLRRKYCt47sVh-WuBtQLBzYm2xWMKi26NNOtG64sFAotA7ccnnQCfLb9O-EuUCq7v1Fp9MbfBfunnfLAYgBiaevEjqwVRladCy4fGXmnBZp3JOGmG3NZFiATL8-eu3qpx6p2XC08RXFxmSNOy_GZ5p5JR0fB3s34_CUnaea8pcGa5Voy4tRtUuns0WnP4fbpAKos5Hw4BFIhMvUCagWDS2mHlbxKgfi3_WT2jqUB0_oHeF3n2m_fN-2fL06gZ7TtTw_xviqcr7foNUmTxeu8USsKuJwFcJ3_3bI9DpheXM-hW4tNF55AphF5mpr6n_B54hhOk9HcIy9kT-EbxSwcwBaO7uWlVfsu2jigwti-uxJzWkiruCkidZqlNca6jJiSmKaS3qKzPcE4JuD63PW65iT5XXLyvj2XI2tgm7g-6Jl7aJ9-QoYIUAnOWEq7xV2qkFb0oUyE6Bo2kpivjmaZjGYXWmXLclMSXPiFMC5G10uqIhyNGE_eY6GpIGnr5fgrhfCn2js0eoFFirctZbtoVVZmworqM68c7OrQSobQHX8hPJNZ33xUtbw3meWjclJ10WqVZOclHBG0Nyf7Zeqgsy18HThVtK98fUBY0Nr3d4LC4hXFH6EkRNwT1ztHSnAJeccVCkn3hLDhLC2nrEOtoengMb-2MJXGuD_RR1OrU6vu1Cl19q40ViIHb3AIH3zptwckQ9mwvsZy2Lm82kvZR3DpWbYFv1IXXTHh7HRpJa3wKJgCxZ1Z1WdWbQEzHvzRnVf30I3OZ8y9z0ly_UTVS7bbrtmbjMv9nSTSbDUfwX0pCoclsMytCg4eLlTIvIeXRt2kE66-tdo1M678doYuypipqBc_7tMe1RgTThiz59PnjPJV9wTBwrLMrsPHLjWfKMlQPO14HROuB-Zo_IcQYGm8GdxAroPK8bIw3qlAvncUtVAtBDorLEPxILlAPysP5yuzaDdIcceekA2wfixBw8j3WJsZgH_gdmPNbsrj53qnF5pKbpPiTgq9kPUiGwD5cpHDRfDE4Xwqkkd2ovjil_lgbkcjq-pe0FNmFVDzIl_etSFS7DViVYh2I0OBGbZxbYG8I870tSMsVx_IljDKjHMO89vdSGNSzIh9q-tjjtVehzlVFpZiKcj5KiPsLe2PqAWTJyWvycdHg9uUa5xnoY-PkuRYTrGaecjfQwYhpqNKVFpaCoGtMBxUAhXxEplaBBlPXs_aXUz0mvj5XkoiOoaqmZkB-NnASpyZTzNCgfLYXc99nMg2Dima-am6w8ZBDMXcmewOnhTx50GZuYw27AT1eEvF4l68GMDRk7kAeypBeCqYcBELD2mwitHaW5sAk8tHXSqPkGZmgGyxpKoN6kbI-my4tVzBq5ideDgH3x7gjA3Kc5BaRYoXWlNsfUb8ScMr81VIUq0pMskSZkZteSj4DxorMQzCkpBmhSPR2fwDbb9FvQLlb7DpiwKqHGNE2rVKyxEd2uDfKPTPoABKbiwT9mBxLlHNdf8ZEwJAmUmZ8UXt5CWPFN44RwQlUV7BvjgEw-oveC56x_WY9brWSESwB27MrRFRjZ-5ab6BIYWJUhJIzmarr4-kBvfWzJJqhDk3fN5XJtLtD1W-HNfJt7R8eYYT0hB2RrlLvklz0m00]--></g></svg>