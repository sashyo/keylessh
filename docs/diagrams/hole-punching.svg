<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1696px" preserveAspectRatio="none" style="width:1140px;height:1696px;background:#0F172A;" version="1.1" viewBox="0 0 1140 1696" width="1140px" zoomAndPan="magnify"><title>NAT Traversal &#8212; Hole Punching via STUN + ICE</title><defs/><g><rect fill="#0F172A" height="1696" style="stroke:none;stroke-width:1;" width="1140" x="0" y="0"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="582.7529" x="277.4648" y="35.4209">NAT Traversal &#8212; Hole Punching via STUN + ICE</text><line style="stroke:#334155;stroke-width:1;" x1="126" x2="126" y1="94.5469" y2="1649.8594"/><line style="stroke:#334155;stroke-width:1;" x1="344.0469" x2="344.0469" y1="94.5469" y2="1649.8594"/><line style="stroke:#334155;stroke-width:1;" x1="449.5859" x2="449.5859" y1="94.5469" y2="1649.8594"/><line style="stroke:#334155;stroke-width:1;" x1="574.2988" x2="574.2988" y1="94.5469" y2="1649.8594"/><line style="stroke:#334155;stroke-width:1;" x1="769.3271" x2="769.3271" y1="94.5469" y2="1649.8594"/><line style="stroke:#334155;stroke-width:1;" x1="948.2373" x2="948.2373" y1="94.5469" y2="1649.8594"/><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="104.8789" x="74" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="48.8906" x="101.9941" y="69.748">Browser</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="90.8789" x="81" y="83.7168">(behind NAT A)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="104.8789" x="74" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="48.8906" x="101.9941" y="1666.998">Browser</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="90.8789" x="81" y="1680.9668">(behind NAT A)</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="50.5391" x="319.0469" y="65.5781"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="36.5391" x="326.0469" y="83.7168">NAT A</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="50.5391" x="319.0469" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="36.5391" x="326.0469" y="1666.998">NAT A</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="100.7129" x="399.5859" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="75.873" x="412.0059" y="69.748">STUN Server</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="86.7129" x="406.5859" y="83.7168">(signaling WS)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="100.7129" x="399.5859" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="75.873" x="412.0059" y="1666.998">STUN Server</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="86.7129" x="406.5859" y="1680.9668">(signaling WS)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="89.873" x="530.2988" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="75.873" x="537.2988" y="69.748">STUN Server</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="68.3145" x="541.0781" y="83.7168">(port 3478)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="89.873" x="530.2988" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="75.873" x="537.2988" y="1666.998">STUN Server</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="68.3145" x="541.0781" y="1680.9668">(port 3478)</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="50.5625" x="744.3271" y="65.5781"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="36.5625" x="751.3271" y="83.7168">NAT B</text><rect fill="#1E293B" height="27.9688" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="50.5625" x="744.3271" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="36.5625" x="751.3271" y="1666.998">NAT B</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="104.9023" x="896.2373" y="51.6094"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="26.9766" x="935.2002" y="69.748">WAF</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="90.9023" x="903.2373" y="83.7168">(behind NAT B)</text><rect fill="#1E293B" height="41.9375" rx="2.5" ry="2.5" style="stroke:#3B82F6;stroke-width:1;" width="104.9023" x="896.2373" y="1648.8594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="26.9766" x="935.2002" y="1666.998">WAF</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="90.9023" x="903.2373" y="1680.9668">(behind NAT B)</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="124.5313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="124.5313" y2="124.5313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="127.5313" y2="127.5313"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="195.8984" x="471.3921" y="114.5469"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="177.7207" x="477.3921" y="129.6855">1. Fetch TURN Credentials</text><polygon fill="#94A3B8" points="437.9424,162.4844,447.9424,166.4844,437.9424,170.4844,441.9424,166.4844" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="443.9424" y1="166.4844" y2="166.4844"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="179.0566" x="133.4395" y="161.6543">GET /webrtc-config (via relay)</text><polygon fill="#94A3B8" points="137.4395,204.4219,127.4395,208.4219,137.4395,212.4219,133.4395,208.4219" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="131.4395" x2="448.9424" y1="208.4219" y2="208.4219"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="152.6133" x="143.4395" y="189.623">{ stunServer, turnServer,</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="186.9609" x="151.0684" y="203.5918">turnUsername, turnPassword }</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="236.4063"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="236.4063" y2="236.4063"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="239.4063" y2="239.4063"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="225.1777" x="456.7524" y="226.4219"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="207" x="462.7524" y="241.5605">2. SDP Offer/Answer Exchange</text><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="168.4395" y1="292.3281" y2="292.3281"/><line style="stroke:#94A3B8;stroke-width:1;" x1="168.4395" x2="168.4395" y1="292.3281" y2="305.3281"/><line style="stroke:#94A3B8;stroke-width:1;" x1="127.4395" x2="168.4395" y1="305.3281" y2="305.3281"/><polygon fill="#94A3B8" points="137.4395,301.3281,127.4395,305.3281,137.4395,309.3281,133.4395,305.3281" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="159.8145" x="133.4395" y="273.5293">new RTCPeerConnection({</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="154.916" x="141.0684" y="287.498">iceServers: [stun, turn] })</text><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="168.4395" y1="333.2969" y2="333.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="168.4395" x2="168.4395" y1="333.2969" y2="346.2969"/><line style="stroke:#94A3B8;stroke-width:1;" x1="127.4395" x2="168.4395" y1="346.2969" y2="346.2969"/><polygon fill="#94A3B8" points="137.4395,342.2969,127.4395,346.2969,137.4395,350.2969,133.4395,346.2969" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="203.877" x="133.4395" y="328.4668">createDataChannel("http-tunnel")</text><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="168.4395" y1="374.2656" y2="374.2656"/><line style="stroke:#94A3B8;stroke-width:1;" x1="168.4395" x2="168.4395" y1="374.2656" y2="387.2656"/><line style="stroke:#94A3B8;stroke-width:1;" x1="127.4395" x2="168.4395" y1="387.2656" y2="387.2656"/><polygon fill="#94A3B8" points="137.4395,383.2656,127.4395,387.2656,137.4395,391.2656,133.4395,387.2656" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="119.707" x="133.4395" y="369.4355">createOffer() &#8594; SDP</text><polygon fill="#94A3B8" points="437.9424,411.2344,447.9424,415.2344,437.9424,419.2344,441.9424,415.2344" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="443.9424" y1="415.2344" y2="415.2344"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="206.25" x="133.4395" y="410.4043">sdp_offer { sdp, fromId, targetId }</text><polygon fill="#94A3B8" points="936.6885,439.2031,946.6885,443.2031,936.6885,447.2031,940.6885,443.2031" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="449.9424" x2="942.6885" y1="443.2031" y2="443.2031"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="105.627" x="456.9424" y="438.373">forward sdp_offer</text><line style="stroke:#94A3B8;stroke-width:1;" x1="948.6885" x2="990.6885" y1="471.1719" y2="471.1719"/><line style="stroke:#94A3B8;stroke-width:1;" x1="990.6885" x2="990.6885" y1="471.1719" y2="484.1719"/><line style="stroke:#94A3B8;stroke-width:1;" x1="949.6885" x2="990.6885" y1="484.1719" y2="484.1719"/><polygon fill="#94A3B8" points="959.6885,480.1719,949.6885,484.1719,959.6885,488.1719,955.6885,484.1719" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="170.9941" x="955.6885" y="466.3418">setRemoteDescription(offer)</text><line style="stroke:#94A3B8;stroke-width:1;" x1="948.6885" x2="990.6885" y1="512.1406" y2="512.1406"/><line style="stroke:#94A3B8;stroke-width:1;" x1="990.6885" x2="990.6885" y1="512.1406" y2="525.1406"/><line style="stroke:#94A3B8;stroke-width:1;" x1="949.6885" x2="990.6885" y1="525.1406" y2="525.1406"/><polygon fill="#94A3B8" points="959.6885,521.1406,949.6885,525.1406,959.6885,529.1406,955.6885,525.1406" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="149.5488" x="955.6885" y="507.3105">&#8594; generates SDP answer</text><polygon fill="#94A3B8" points="460.9424,549.1094,450.9424,553.1094,460.9424,557.1094,456.9424,553.1094" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="454.9424" x2="947.6885" y1="553.1094" y2="553.1094"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="166.002" x="466.9424" y="548.2793">sdp_answer { sdp, fromId }</text><polygon fill="#94A3B8" points="137.4395,577.0781,127.4395,581.0781,137.4395,585.0781,133.4395,581.0781" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="131.4395" x2="448.9424" y1="581.0781" y2="581.0781"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="120.8613" x="143.4395" y="576.248">forward sdp_answer</text><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="168.4395" y1="609.0469" y2="609.0469"/><line style="stroke:#94A3B8;stroke-width:1;" x1="168.4395" x2="168.4395" y1="609.0469" y2="622.0469"/><line style="stroke:#94A3B8;stroke-width:1;" x1="127.4395" x2="168.4395" y1="622.0469" y2="622.0469"/><polygon fill="#94A3B8" points="137.4395,618.0469,127.4395,622.0469,137.4395,626.0469,133.4395,622.0469" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="186.2285" x="133.4395" y="604.2168">setRemoteDescription(answer)</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="650.0313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="650.0313" y2="650.0313"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="653.0313" y2="653.0313"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="310.9355" x="413.8735" y="640.0469"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="292.7578" x="419.8735" y="655.1855">3. STUN Binding &#8212; Discover Public Address</text><polygon fill="#94A3B8" points="332.3164,687.9844,342.3164,691.9844,332.3164,695.9844,336.3164,691.9844" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="338.3164" y1="691.9844" y2="691.9844"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="134.9648" x="133.4395" y="687.1543">STUN Binding Request</text><polygon fill="#94A3B8" points="563.2354,715.9531,573.2354,719.9531,563.2354,723.9531,567.2354,719.9531" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="344.3164" x2="569.2354" y1="719.9531" y2="719.9531"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="170.373" x="351.3164" y="715.123">(NAT assigns 5.6.7.8:54321)</text><line style="stroke:#94A3B8;stroke-width:1;" x1="575.2354" x2="617.2354" y1="747.9219" y2="747.9219"/><line style="stroke:#94A3B8;stroke-width:1;" x1="617.2354" x2="617.2354" y1="747.9219" y2="760.9219"/><line style="stroke:#94A3B8;stroke-width:1;" x1="576.2354" x2="617.2354" y1="760.9219" y2="760.9219"/><polygon fill="#94A3B8" points="586.2354,756.9219,576.2354,760.9219,586.2354,764.9219,582.2354,760.9219" style="stroke:#94A3B8;stroke-width:1;"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="166.6758" x="582.2354" y="743.0918">Read source: 5.6.7.8:54321</text><polygon fill="#94A3B8" points="355.3164,812.8281,345.3164,816.8281,355.3164,820.8281,351.3164,816.8281" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="349.3164" x2="574.2354" y1="816.8281" y2="816.8281"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="97.4648" x="361.3164" y="784.0605">Binding Success</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="146.4082" x="361.3164" y="798.0293">XOR-MAPPED-ADDRESS:</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="84.1992" x="368.9453" y="811.998">5.6.7.8:54321</text><polygon fill="#94A3B8" points="137.4395,840.7969,127.4395,844.7969,137.4395,848.7969,133.4395,844.7969" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="131.4395" x2="343.3164" y1="844.7969" y2="844.7969"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="155.0801" x="143.4395" y="839.9668">(server-reflexive address)</text><path d="M10,857.7969 L10,908.7969 L242,908.7969 L242,867.7969 L232,857.7969 L10,857.7969 " fill="#1E293B" style="stroke:#334155;stroke-width:1;"/><path d="M232,857.7969 L232,867.7969 L242,867.7969 L232,857.7969 " fill="#1E293B" style="stroke:#334155;stroke-width:1;"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="123.2871" x="16" y="873.9355">Browser now knows:</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="211.8809" x="16" y="887.9043">host candidate: 192.168.1.5:54321</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="181.2832" x="16" y="901.873">srflx candidate: 5.6.7.8:54321</text><polygon fill="#94A3B8" points="780.6084,930.6719,770.6084,934.6719,780.6084,938.6719,776.6084,934.6719" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="774.6084" x2="947.6885" y1="934.6719" y2="934.6719"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="134.9648" x="786.6084" y="929.8418">STUN Binding Request</text><polygon fill="#94A3B8" points="586.2354,958.6406,576.2354,962.6406,586.2354,966.6406,582.2354,962.6406" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="580.2354" x2="768.6084" y1="962.6406" y2="962.6406"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="170.373" x="592.2354" y="957.8105">(NAT assigns 9.8.7.6:12345)</text><polygon fill="#94A3B8" points="757.6084,1014.5469,767.6084,1018.5469,757.6084,1022.5469,761.6084,1018.5469" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="575.2354" x2="763.6084" y1="1018.5469" y2="1018.5469"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="97.4648" x="582.2354" y="985.7793">Binding Success</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="146.4082" x="582.2354" y="999.748">XOR-MAPPED-ADDRESS:</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="84.1992" x="589.8643" y="1013.7168">9.8.7.6:12345</text><polygon fill="#94A3B8" points="936.6885,1042.5156,946.6885,1046.5156,936.6885,1050.5156,940.6885,1046.5156" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="769.6084" x2="942.6885" y1="1046.5156" y2="1046.5156"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="155.0801" x="776.6084" y="1041.6855">(server-reflexive address)</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="1074.5"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1074.5" y2="1074.5"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1077.5" y2="1077.5"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="198.7637" x="469.9595" y="1064.5156"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="180.5859" x="475.9595" y="1079.6543">4. ICE Candidate Exchange</text><polygon fill="#94A3B8" points="437.9424,1112.4531,447.9424,1116.4531,437.9424,1120.4531,441.9424,1116.4531" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="443.9424" y1="1116.4531" y2="1116.4531"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="204.1816" x="133.4395" y="1111.623">candidate { srflx: 5.6.7.8:54321 }</text><polygon fill="#94A3B8" points="936.6885,1140.4219,946.6885,1144.4219,936.6885,1148.4219,940.6885,1144.4219" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="449.9424" x2="942.6885" y1="1144.4219" y2="1144.4219"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="109.5996" x="456.9424" y="1139.5918">forward candidate</text><polygon fill="#94A3B8" points="460.9424,1168.3906,450.9424,1172.3906,460.9424,1176.3906,456.9424,1172.3906" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="454.9424" x2="947.6885" y1="1172.3906" y2="1172.3906"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="204.1816" x="466.9424" y="1167.5605">candidate { srflx: 9.8.7.6:12345 }</text><polygon fill="#94A3B8" points="137.4395,1196.3594,127.4395,1200.3594,137.4395,1204.3594,133.4395,1200.3594" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="131.4395" x2="448.9424" y1="1200.3594" y2="1200.3594"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="109.5996" x="143.4395" y="1195.5293">forward candidate</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="1228.3438"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1228.3438" y2="1228.3438"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1231.3438" y2="1231.3438"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="310.1914" x="414.2456" y="1218.3594"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="292.0137" x="420.2456" y="1233.498">5. ICE Connectivity Checks (Hole Punching)</text><path d="M66,1255.3281 L66,1306.3281 L1008,1306.3281 L1008,1265.3281 L998,1255.3281 L66,1255.3281 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><path d="M998,1255.3281 L998,1265.3281 L1008,1265.3281 L998,1255.3281 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="277.7168" x="393.7114" y="1271.4668">Both peers simultaneously send STUN binding</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="270.7441" x="393.7114" y="1285.4355">requests to each other's reflexive addresses.</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="210.0059" x="393.7114" y="1299.4043">This "punches holes" in both NATs.</text><polygon fill="#94A3B8" points="332.3164,1328.2031,342.3164,1332.2031,332.3164,1336.2031,336.3164,1332.2031" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="126.4395" x2="338.3164" y1="1332.2031" y2="1332.2031"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="142.4883" x="133.4395" y="1327.373">packet &#8594; 9.8.7.6:12345</text><polygon fill="#94A3B8" points="757.6084,1356.1719,767.6084,1360.1719,757.6084,1364.1719,761.6084,1360.1719" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="344.3164" x2="763.6084" y1="1360.1719" y2="1360.1719"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="239.4316" x="351.3164" y="1355.3418">(creates NAT mapping for return traffic)</text><polygon fill="#94A3B8" points="780.6084,1384.1406,770.6084,1388.1406,780.6084,1392.1406,776.6084,1388.1406" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="774.6084" x2="947.6885" y1="1388.1406" y2="1388.1406"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="142.4883" x="786.6084" y="1383.3105">packet &#8594; 5.6.7.8:54321</text><polygon fill="#94A3B8" points="355.3164,1412.1094,345.3164,1416.1094,355.3164,1420.1094,351.3164,1416.1094" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="349.3164" x2="768.6084" y1="1416.1094" y2="1416.1094"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="239.4316" x="361.3164" y="1411.2793">(creates NAT mapping for return traffic)</text><polygon fill="#94A3B8" points="137.4395,1440.0781,127.4395,1444.0781,137.4395,1448.0781,133.4395,1444.0781" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="131.4395" x2="343.3164" y1="1444.0781" y2="1444.0781"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="139.7109" x="143.4395" y="1439.248">return traffic now flows</text><polygon fill="#94A3B8" points="936.6885,1468.0469,946.6885,1472.0469,936.6885,1476.0469,940.6885,1472.0469" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="769.6084" x2="942.6885" y1="1472.0469" y2="1472.0469"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="139.7109" x="776.6084" y="1467.2168">return traffic now flows</text><path d="M66,1485.0469 L66,1522.0469 L1008,1522.0469 L1008,1495.0469 L998,1485.0469 L66,1485.0469 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><path d="M998,1485.0469 L998,1495.0469 L1008,1495.0469 L998,1485.0469 " fill="#334155" style="stroke:#334155;stroke-width:1;"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="183.6621" x="401.9585" y="1501.1855">Bidirectional path established!</text><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="261.2227" x="401.9585" y="1515.1543">NAT mappings allow direct communication.</text><rect fill="#334155" height="3" style="stroke:#334155;stroke-width:1;" width="1128.6826" x="5" y="1547.9688"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1547.9688" y2="1547.9688"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1133.6826" y1="1550.9688" y2="1550.9688"/><rect fill="#334155" height="21.9688" style="stroke:#000000;stroke-width:1;" width="168.7344" x="484.9741" y="1537.9844"/><text fill="#F8FAFC" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="150.5566" x="490.9741" y="1553.123">6. DataChannel Opens</text><polygon fill="#94A3B8" points="137.4395,1585.9219,127.4395,1589.9219,137.4395,1593.9219,133.4395,1589.9219" style="stroke:#94A3B8;stroke-width:1;"/><polygon fill="#94A3B8" points="936.6885,1585.9219,946.6885,1589.9219,936.6885,1593.9219,940.6885,1589.9219" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="131.4395" x2="942.6885" y1="1589.9219" y2="1589.9219"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="158.209" x="143.4395" y="1585.0918">P2P DataChannel OPEN</text><polygon fill="#94A3B8" points="460.9424,1627.8594,450.9424,1631.8594,460.9424,1635.8594,456.9424,1631.8594" style="stroke:#94A3B8;stroke-width:1;"/><line style="stroke:#94A3B8;stroke-width:1;" x1="454.9424" x2="947.6885" y1="1631.8594" y2="1631.8594"/><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="75.832" x="466.9424" y="1613.0605">client_status</text><text fill="#94A3B8" font-family="Segoe UI" font-size="12" lengthAdjust="spacing" textLength="211.957" x="466.9424" y="1627.0293">{ clientId, connectionType: "p2p" }</text><!--SRC=[bLRRRkCs47tNLyow3xNJM5lV4iTe5l0jsm2jOzWEja2tMD3Io2OYKrgIjfC60VhK3oZwXVib7LAoRFaIf0y94iwPcJE7CqEzqtDS8CGXuyBHN8S8W_O49fAjK2eMmhU__eMV8peUBeKtvs86AyvWFBaVm0zms-qxZdhW8cQIBU3P0PWoxs4cewNmkr4OIVZknw1oMMLayJ5Wor3VH4Adfg0PiC3BcmQCw1J6E8iGxcyBUUEO_ubGgTBX6BykKNZu2m_eHs0daZxAD6wjLgyq6iTG- -GgMBsgJGavP59pZyTCwBU1SlccpMfmaGSSAxCjPRHE3w_gZDmsXplep328z2k4hVLeqSPoBFj6Z8yKBpuTE0zxLTOUNt4o7yGw1JnazU8uyLOpA7H82uNoioXEaPhDjytOBXM0APWcjengpj7YB4mmtJwEiKqxHhco2HIV2HQQXluqJXBGoLiSuqXggDKlcwcNNehJd3eRJftZc4_jctondIJgcWMPWtDz3HKNRb1xSvZSZmRGbUYZq9o52gwl7MSZJVc3BQ857_iJUB_6gTHUsOj4G8T5CxSIG_PKSWoeJE2DNmkURHr9ZUUWbtBpzsS1zjzxmWcQpSGuP4gjgJVWnRAhkZ3k3U4k252-RmkrffZzHs_En0pt2Mvp2bp3QD8Tekam8T3JF1B5PvEHUvZaLotutJ1Bqlu1BwNZiJo9J6EFQTQbh0B3Oc6kTLmcL_gdyAgNfLqimRU__p5b795J-V6NoA2CJdvy3e6C5hS-aM9oXlhMw60r_M0lhWL19DUCvCaS7SSOChj2FS853MeFbITvR2ktm58UQ3ZDKA0adigApAoyMRmjmSIGPxZbjIrwbriQxAWuHpac3YLxwpKtUGSwrBjcZinJqUFAY-ZUwBcOXjo3jkzBL0TTQeUqbNSVcMMXj6DjfZ8pM2qecgcWTgDnLT1mBznBjzbgr6lL2lMnWMoX8sHKLhIK7hRoK2U5RbDliewNdaS4FulVxaRbNzl3ORzNRlTwe_vut3ATc0-JSCl9L5IsKSiIWn0V-Gg19JMJI8BK0oj7YgUTcAuu4D4Q7kYNQj7XF58QF4QKVBhe5bIkgcxbekbMt4QQ6K3987pS1UMf8IqGao_h3BjqJclSEQNnbTkai1UjIhLMRvHomdN-Xt2vC6d2hArV4uqwg-wQJmleRcezkKoIxiyqCSrlLDhJvjHqPdvxqtGaNgwQrwPg9oOLqaWBITVRYkidwCxHUr1Gp7rLbMnb1_rodZm4sOFQYVGSObgOvhLQq5SH4nWjLVX4qqhtR-zwcbmGeMLosmfq1CZeyI1lbDyhE90TbKluoPmhACI64YsREV5J1U02fYOhjGY1jbrsECqnVGUWjYlhuFBREnrPJDQkik_TWiMnQIVIZsYP9GzQiY3WNcc_atVY7qnbPuV7s-CV6USynavf499nluDFujvmYTpdCddjw0CxPYGktHAZVQdcwBypdt1RuWfOI74XSG4lMYoMWdlCUEzU1pNRXGix3o3SnIZoY_UdZFtPsR0wpAE7_S7PsVuWX9m-CxuGERsaINzE3ypBvsKlzkGffcLKYAjnWGRZFm00]--></g></svg>